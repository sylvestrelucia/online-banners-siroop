{% macro panel(item) %}
	{% import _self as macros %}
	{% if item.items %}
		<li class="o-filter-panel__item{% if item.active %} o-filter-panel__item--active{% endif %}">
			<form action="?a">
				<div class="o-filter-panel__item-wrapper">
					{# Foldable filters on large screen #}
					<input
							class="o-filter-panel__accordion"
							id="o-filter-panel__accordion-item-{{ item.name }}"
							name="{{ item.name }}"
							type="checkbox"
							{{ item.value }}
					/>
					<label
							class="o-filter-panel__accordion-label"
							for="o-filter-panel__accordion-item-{{ item.name }}"
					>
						{{ item.name }}
						<span class="o-filter-panel__accordion-icon-plus">
							{% include '@a-svg-icon' with {
							modifiers: ['stroked-thin', 'small'],
							data: {
							name: 'plus'
							}
							} %}
						</span>
						<span class="o-filter-panel__accordion-icon-minus">
							{% include '@a-svg-icon' with {
							modifiers: ['stroked-thin', 'small'],
							data: {
							name: 'minus'
							}
							} %}
						</span>
					</label>
					<button
						class="o-filter-panel__item-link o-filter-panel__item-link--have-subpanel js-o-filter-panel__item-link">
						{{ item.name|raw }}
						<span class="o-filter-panel__item-next">
									{% include "@a-svg-icon" with {
									modifiers: ['small', 'stroked-thin'],
									data: {
									name: 'arrow-right'
									}
									} %}
								</span>
					</button>

					<div class="o-filter-panel__panel js-o-filter-panel__panel">
						<div class="o-filter-panel__header">
							{{ block('back') }}
							<span class="o-filter-panel__header-title">{{ item.back }}</span>
						</div>
						<div class="o-filter-panel__container">
							{{ macros.panel(item) }}
						</div>
					</div>
				</div>
			</form>
		</li>
	{% elseif item.content %}
		<li class="o-filter-panel__item{% if item.active %} o-filter-panel__item--active{% endif %}">
			<form action="?b">
				<div class="o-filter-panel__item-wrapper">

					{# Foldable filters on large screen #}
					<input
						class="o-filter-panel__accordion"
						id="o-filter-panel__accordion-item-{{ item.name }}"
						name="{{ item.name }}"
						type="checkbox"
						{{ item.value }}
					/>
					<label
						class="o-filter-panel__accordion-label"
						for="o-filter-panel__accordion-item-{{ item.name }}"
					>
						{{ item.name }}
						<span class="o-filter-panel__accordion-icon-plus">
							{% include '@a-svg-icon' with {
							modifiers: ['stroked-thin', 'small'],
							data: {
							name: 'plus'
							}
							} %}
						</span>
						<span class="o-filter-panel__accordion-icon-minus">
							{% include '@a-svg-icon' with {
							modifiers: ['stroked-thin', 'small'],
							data: {
							name: 'minus'
							}
							} %}
						</span>
					</label>

					<button
						class="o-filter-panel__item-link o-filter-panel__item-link--have-subpanel js-o-filter-panel__item-link">
						{{ item.name }}
						<span class="o-filter-panel__item-next">
									{% include "@a-svg-icon" with {
									modifiers: ['small', 'stroked-thin'],
									data: {
									name: 'arrow-right'
									}
									} %}
						</span>
					</button>

					<div class="o-filter-panel__panel js-o-filter-panel__panel">
						<div class="o-filter-panel__header">
							{{ block('back') }}
							<span class="o-filter-panel__header-title">{{ item.back }}</span>
						</div>
						<div class="o-filter-panel__container">
							<div class="o-filter-panel__container-title">{{ item.content.name }}</div>
							{% if item.content.component %}
								{% include '@' ~ item.content.component.name with { data: item.content.component.data } %}
							{% endif %}
						</div>
						<div class="o-filter-panel__footer">
							{% for button in item.buttons %}
								{{ block('button') }}
							{% endfor %}
						</div>
					</div>
				</div>
			</form>
		</li>
	{% else %}

		<li class="o-filter-panel__link{% if item.active %} o-filter-panel__link--active{% endif %}">
			<a href="{{ item.url }}" class="o-filter-panel__link-sub">
				{{ item.name|raw }}
			</a>
		</li>

	{% endif %}
{% endmacro %}

{% import _self as macros %}

<div class="o-filter-panel js-o-filter-panel{% if modifier %} o-filter-panel--{{ modifier }}{% endif %}"
	 data-c-name="FilterPanel">

	{% if data.triggerButton.default %}
		<button class="o-filter-panel__button">{{ data.triggerButton.text }}</button>
	{% endif %}

	<div role="dialog" aria-label="{{ data.name }}"
		 class="o-filter-panel__panel js-o-filter-panel__panel js-o-filter-panel__panel--main-panel"
		 data-trigger-by="{{ data.triggerButton.class }}">
		<div class="o-filter-panel__header">

			{% block back %}
				<button aria-label="{{ data.back }}" class="o-filter-panel__header-back js-o-filter-panel__back">
					{% include "@a-svg-icon" with {
					modifiers: ['small', 'stroked-thin'],
					data: {
					name: 'arrow-left'
					}
					} %}
				</button>
			{% endblock %}

			<span class="o-filter-panel__header-title">
				{{ data.back }}
			</span>
		</div>

		<div class="o-filter-panel__container">

			{% if data.activeCategories %}
				<div class="o-filter-panel__active-categories">
					<div class="o-filter-panel__filter-title o-filter-panel__filter-title--first">{{ data.activeCategories.name }}</div>
					{% include "@o-link-list" with { data: data.activeCategories } %}
				</div>
			{% endif %}

			{% if data.activeFilters %}
				{#  TODO:: Move into seprate pill-list or a similar component #}
				<div class="o-filter-panel__active-filters">
					<ul class="o-filter-panel__filters">
						{% for item in data.activeFilters.items %}
							<li class="o-filter-panel__filter">
								{% include "@m-filter-pill" with {
								modifier: 'active',
								data: {
								text: item.text
								}
								} %}
							</li>
						{% endfor %}
					</ul>
					{% include "@m-filter-pill" with {
					modifier: 'neutral',
					data: {
					text: data.activeFilters.resetFilter
					}
					} %}
				</div>
			{% endif %}
			<ul class="o-filter-panel__list">
				{% for item in data.items %}
					{{ macros.panel(item) }}
				{% endfor %}
			</ul>
		</div>

		<div class="o-filter-panel__footer o-filter-panel__footer--main">
			{% for button in data.buttons %}
				{% block button %}
					<button
						class="o-filter-panel__footer-button js-o-filter-panel__footer-button{% for modifier in button.modifiers %} o-filter-panel__footer-button--{{ modifier }}{% endfor %}{% for class in button.classes %} {{ class }}{% endfor %}">
						{{ button.name }}
					</button>
				{% endblock %}
			{% endfor %}
		</div>

	</div>

</div>
